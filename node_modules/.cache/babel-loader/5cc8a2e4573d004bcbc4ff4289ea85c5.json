{"ast":null,"code":"import { db, storage, time } from './firebase';\nexport const initialState = {\n  users: [],\n  products: []\n};\nexport const reducer = (prevState = initialState, action) => {\n  const customersRef = db.collection('user');\n  const productsRef = db.collection('product');\n\n  switch (action.type) {\n    case \"update_user\":\n      let updatedUser = [...prevState.users];\n      console.log(action);\n      return { ...prevState,\n        users: [...updatedUser]\n      };\n\n    case \"delete_user\":\n      let copyUsers = [...prevState.users];\n      console.log(\"Delete User Action: \", action);\n\n      try {\n        customersRef.where(\"userID\", \"==\", `${action.targetID}`).get().then(snapshot => {\n          snapshot.forEach(user => {\n            customersRef.doc(user.id).delete();\n            let userIndex = copyUsers.findIndex(user => user.userID === user.data().userID);\n\n            if (userIndex >= 0) {\n              copyUsers.splice(userIndex, 1);\n            }\n          });\n        }).catch(error => console.log(\"Deletion Error: \", error));\n      } catch (error) {\n        console.log(\"Deletion Error: \", error);\n      }\n\n      return { ...prevState,\n        users: [...copyUsers]\n      };\n\n    case \"add_product\":\n      let addProduct = [...prevState.products];\n      console.log(\"Add Action: \", action);\n\n      try {\n        const {\n          product_name,\n          product_descr,\n          product_cat,\n          product_price\n        } = action.updateData;\n        storage.ref(`/products/${product_cat}/${product_name}`).put(action.image, {\n          contentType: 'image/png'\n        }).on(\"state_changed\", snapshot => {\n          const prog = Math.round(snapshot.bytesTransferred / snapshot.totalBytes * 100); // setProgress(prog);\n          // console.log(snapshot, progress)\n        }, error => {\n          console.log(error);\n          alert(error.message);\n        }, () => {\n          storage.ref(`/products/${product_cat}/`).child(product_name).getDownloadURL().then(url => {\n            productsRef.add({\n              product_id: productsRef.doc().id,\n              product_name: product_name,\n              product_descr: product_descr,\n              product_image: url,\n              product_price: product_price,\n              product_cat: product_cat,\n              dateadded: time\n            });\n          }).catch(error => console.log(\"Error Adding Firestore Products: \", error));\n        });\n      } catch (error) {\n        console.log(\"Error Updating Storage: \", error);\n      }\n\n      return { ...prevState,\n        products: [...addProduct]\n      };\n\n    case \"update_product_info\":\n      let updateProducts = [...prevState.products];\n      console.log(\"Update Action: \", action);\n\n      try {\n        const {\n          product_name,\n          product_descr,\n          product_cat,\n          product_price\n        } = action.updateData;\n        storage.ref(`/products/${product_cat}/${product_name}`).put(action.image, {\n          contentType: 'image/png'\n        }).on(\"state_changed\", snapshot => {\n          const prog = Math.round(snapshot.bytesTransferred / snapshot.totalBytes * 100); // setProgress(prog);\n          // console.log(snapshot, progress)\n        }, error => {\n          console.log(error);\n          alert(error.message);\n        }, () => {\n          storage.ref(`/products/${product_cat}/`).child(product_name).getDownloadURL().then(url => {\n            productsRef.where(\"product_id\", \"==\", `${action.targetID}`).get().then(snapshot => {\n              snapshot.forEach(item => {\n                productsRef.doc(item.id).set({\n                  product_id: productsRef.doc().id,\n                  product_name: product_name,\n                  product_descr: product_descr,\n                  product_image: url,\n                  product_price: product_price,\n                  product_cat: product_cat,\n                  dateadded: time\n                }, {\n                  merge: true\n                });\n              });\n            });\n          }).catch(error => console.log(\"Error Adding Firestore Products: \", error));\n        });\n      } catch (error) {\n        console.log(\"Update Error: \", error);\n      }\n\n      return { ...prevState,\n        products: updateProducts\n      };\n\n    case \"delete_product\":\n      let copyProducts = [...prevState.products];\n\n      try {\n        productsRef.where(\"product_id\", \"==\", `${action.targetID}`).get().then(snapshot => {\n          snapshot.forEach(item => {\n            productsRef.doc(item.id).delete();\n            let prodIndex = copyProducts.findIndex(product => product.product_id === item.data().product_id);\n\n            if (prodIndex >= 0) {\n              copyProducts.splice(prodIndex, 1);\n            }\n          }); // console.log(copyProducts)\n        }).catch(error => console.log(error));\n      } catch (error) {\n        console.log(\"Deletion Error: \", error);\n      }\n\n      return { ...prevState,\n        products: copyProducts\n      };\n\n    case \"fetch_products\":\n      let fetchedProducts = [...prevState.products];\n\n      try {\n        productsRef.onSnapshot(snapshot => {\n          snapshot.docChanges().forEach(item => {\n            if (fetchedProducts.length === 0) {\n              fetchedProducts.push(item.doc.data());\n            } else {\n              let itemExists = fetchedProducts.findIndex(product => product.product_id === item.doc.data().product_id);\n\n              if (itemExists < 0) {\n                fetchedProducts.push(item.doc.data());\n              }\n            }\n          });\n        });\n      } catch (error) {\n        console.log(error);\n      }\n\n      return { ...prevState,\n        products: fetchedProducts // products: [...fetchedProducts],\n\n      };\n\n    default:\n      return prevState;\n  }\n};","map":{"version":3,"sources":["/Users/matildamwendwa/Documents/Strathmore/Year 2/Web Application Dev/react_semester_project/src/components/reducer.js"],"names":["db","storage","time","initialState","users","products","reducer","prevState","action","customersRef","collection","productsRef","type","updatedUser","console","log","copyUsers","where","targetID","get","then","snapshot","forEach","user","doc","id","delete","userIndex","findIndex","userID","data","splice","catch","error","addProduct","product_name","product_descr","product_cat","product_price","updateData","ref","put","image","contentType","on","prog","Math","round","bytesTransferred","totalBytes","alert","message","child","getDownloadURL","url","add","product_id","product_image","dateadded","updateProducts","item","set","merge","copyProducts","prodIndex","product","fetchedProducts","onSnapshot","docChanges","length","push","itemExists"],"mappings":"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","sourcesContent":["\nimport { db, storage, time } from './firebase'\n\nexport const initialState = {\n    users: [],\n    products: []\n\n};\n\n\nexport const reducer = (prevState = initialState, action) => {\n    const customersRef = db.collection('user')\n    const productsRef = db.collection('product')\n\n    switch(action.type) {\n\n        case \"update_user\": \n\n            let updatedUser = [...prevState.users]\n            console.log(action)\n            return {\n                 ...prevState, \n                users: [...updatedUser]            \n            }\n        case \"delete_user\": \n\n            let copyUsers = [...prevState.users]\n            console.log(\"Delete User Action: \", action)\n\n             try{ \n                customersRef\n                    .where(\"userID\", \"==\", `${action.targetID}`)\n                    .get()\n                    .then( snapshot => {\n                        snapshot.forEach( user => {\n                            customersRef.doc(user.id).delete() \n                            let userIndex = copyUsers.findIndex( user => user.userID === user.data().userID)  \n                            if (userIndex >= 0) {\n                               copyUsers.splice(userIndex, 1);\n                            }                              \n                        })\n                    })\n                    .catch(error => console.log(\"Deletion Error: \", error))         \n            }catch(error){\n                console.log(\"Deletion Error: \", error)\n            }           \n            return {\n                 ...prevState, \n                users: [...copyUsers ]            \n            }\n\n        case \"add_product\": \n\n            let addProduct = [...prevState.products]\n            console.log(\"Add Action: \" ,action)\n            try{\n                const { product_name, product_descr, product_cat, product_price } = action.updateData\n\n                storage\n                    .ref(`/products/${product_cat}/${product_name}`)\n                    .put(action.image, {contentType: 'image/png'},)\n                    .on(\"state_changed\" , \n                        (snapshot) => {\n                        const prog = Math.round(\n                        (snapshot.bytesTransferred / snapshot.totalBytes) *  100\n                        );\n                        // setProgress(prog);\n                        // console.log(snapshot, progress)\n                    },\n                    (error) => {\n                        console.log(error);\n                        alert(error.message);\n                    },\n                    () => {\n                        storage\n                        .ref(`/products/${product_cat}/`)\n                        .child(product_name)\n                        .getDownloadURL()\n                        .then((url) => {\n                            productsRef.add({\n                                product_id: productsRef.doc().id,\n                                product_name: product_name,\n                                product_descr : product_descr,\n                                product_image: url,\n                                product_price: product_price,\n                                product_cat: product_cat,\n                                dateadded: time,\n                                })\n                        })                  \n                        .catch( error => console.log(\"Error Adding Firestore Products: \", error))\n                        }\n                    )\n            }catch(error){\n                console.log(\"Error Updating Storage: \", error)\n            }\n\n            return {\n                 ...prevState, \n                products: [...addProduct]            \n            }     \n\n        case \"update_product_info\":\n            let updateProducts = [...prevState.products]\n            console.log(\"Update Action: \" ,action)\n            try {\n                const { product_name, product_descr, product_cat, product_price } = action.updateData\n\n                storage\n                    .ref(`/products/${product_cat}/${product_name}`)\n                    .put(action.image, {contentType: 'image/png'},)\n                    .on(\"state_changed\" , \n                        (snapshot) => {\n                        const prog = Math.round(\n                        (snapshot.bytesTransferred / snapshot.totalBytes) *  100\n                        );\n                        // setProgress(prog);\n                        // console.log(snapshot, progress)\n                    },\n                    (error) => {\n                        console.log(error);\n                        alert(error.message);\n                    },\n                    () => {\n                        storage\n                        .ref(`/products/${product_cat}/`)\n                        .child(product_name)\n                        .getDownloadURL()\n                        .then((url) => {\n                        productsRef\n                            .where(\"product_id\", \"==\", `${action.targetID}`)\n                            .get()\n                            .then( snapshot => {\n                                snapshot.forEach( item => {\n                                    productsRef\n                                        .doc(item.id)\n                                        .set({\n                                                product_id: productsRef.doc().id,\n                                                product_name: product_name,\n                                                product_descr : product_descr,\n                                                product_image: url,\n                                                product_price: product_price,\n                                                product_cat: product_cat,\n                                                dateadded: time,\n                                        }\n                                        , {merge: true})\n                                })\n                            })\n                        })                  \n                        .catch( error => console.log(\"Error Adding Firestore Products: \", error))                        \n\n                    } \n                    )               \n            }catch(error){\n                console.log(\"Update Error: \", error)\n            }\n            return {\n                ...prevState, \n                products: updateProducts  \n            }\n\n        case \"delete_product\":\n            let copyProducts =  [...prevState.products];\n            try{ \n                productsRef\n                    .where(\"product_id\", \"==\", `${action.targetID}`)\n                    .get()\n                    .then( snapshot => {\n                        snapshot.forEach( item => {\n                            productsRef.doc(item.id).delete() \n                            let prodIndex = copyProducts.findIndex( product => product.product_id ===item.data().product_id)  \n                            if (prodIndex >= 0) {\n                               copyProducts.splice(prodIndex, 1);\n                            }                           \n                        })\n                        // console.log(copyProducts)\n                    })\n                    .catch( error => console.log(error))\n                    \n                    \n            }catch(error){\n                console.log(\"Deletion Error: \", error)\n            }            \n            return {\n                ...prevState, \n                products: copyProducts              \n            }\n\n        case \"fetch_products\":\n            let fetchedProducts = [...prevState.products];\n            try{\n                productsRef \n                .onSnapshot((snapshot) => {\n                    snapshot.docChanges().forEach( item => {\n                        if(fetchedProducts.length === 0){\n                            fetchedProducts.push(item.doc.data())\n                        }else{\n                            let itemExists = fetchedProducts.findIndex( product => product.product_id === item.doc.data().product_id)\n\n                            if(itemExists < 0){\n                                fetchedProducts.push(item.doc.data())\n                            }\n                        }\n                    })\n                })\n            }catch(error){\n                console.log(error)\n            }\n            return{\n                ...prevState, \n                products: fetchedProducts,\n                // products: [...fetchedProducts],\n            }\n\n        default: \n            return prevState;\n    }\n}\n\n"]},"metadata":{},"sourceType":"module"}