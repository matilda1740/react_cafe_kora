{"ast":null,"code":"import { db } from './firebase';\nexport const initialState = {\n  users: [],\n  products: []\n};\nexport const reducer = (prevState = initialState, action) => {\n  const customersRef = db.collection('user');\n  const productsRef = db.collection('product');\n\n  switch (action.type) {\n    case \"fetch_products\":\n      let copyProducts = [...prevState.products];\n      console.log(action);\n      productsRef.onSnapshot(snapshot => {\n        snapshot.docs.forEach(item => {\n          let itemExists = copyProducts.find(product => product.product_id === action.item.product_id);\n\n          if (!itemExists) {\n            copyProducts.push(item.data());\n          }\n        });\n      }, error => {\n        console.log(error);\n      });\n      return { ...prevState,\n        products: copyProducts\n      };\n\n    case \"fetch_user_details\":\n      let copyUsers = [...prevState.users];\n      let selectedUser;\n      customersRef.where(\"userID\", \"==\", `${action.targetID}`).get().then(snapshot => {\n        snapshot.forEach(user => {\n          selectedUser = user.data();\n          return selectedUser;\n        });\n      }).catch(error => console.log(\"Update Error: \", error));\n      console.log(action, selectedUser);\n      return { ...prevState,\n        users: copyUsers\n      };\n\n    default:\n      return prevState;\n  } // return prevState;\n\n};","map":{"version":3,"sources":["/Users/matildamwendwa/Documents/Strathmore/Year 2/Web Application Dev/react_semester_project/src/components/reducer.js"],"names":["db","initialState","users","products","reducer","prevState","action","customersRef","collection","productsRef","type","copyProducts","console","log","onSnapshot","snapshot","docs","forEach","item","itemExists","find","product","product_id","push","data","error","copyUsers","selectedUser","where","targetID","get","then","user","catch"],"mappings":"AACA,SAASA,EAAT,QAAmB,YAAnB;AAEA,OAAO,MAAMC,YAAY,GAAG;AACxBC,EAAAA,KAAK,EAAE,EADiB;AAExBC,EAAAA,QAAQ,EAAE;AAFc,CAArB;AAOP,OAAO,MAAMC,OAAO,GAAG,CAACC,SAAS,GAAGJ,YAAb,EAA2BK,MAA3B,KAAsC;AACzD,QAAMC,YAAY,GAAGP,EAAE,CAACQ,UAAH,CAAc,MAAd,CAArB;AACA,QAAMC,WAAW,GAAGT,EAAE,CAACQ,UAAH,CAAc,SAAd,CAApB;;AAGA,UAAOF,MAAM,CAACI,IAAd;AAEI,SAAK,gBAAL;AACI,UAAIC,YAAY,GAAG,CAAC,GAAGN,SAAS,CAACF,QAAd,CAAnB;AACAS,MAAAA,OAAO,CAACC,GAAR,CAAYP,MAAZ;AACAG,MAAAA,WAAW,CACVK,UADD,CACaC,QAAD,IAAc;AACtBA,QAAAA,QAAQ,CAACC,IAAT,CAAcC,OAAd,CAAuBC,IAAI,IAAI;AAE3B,cAAIC,UAAU,GAAGR,YAAY,CAACS,IAAb,CAAmBC,OAAO,IAAIA,OAAO,CAACC,UAAR,KAAuBhB,MAAM,CAACY,IAAP,CAAYI,UAAjE,CAAjB;;AAEA,cAAG,CAACH,UAAJ,EAAgB;AAChBR,YAAAA,YAAY,CAACY,IAAb,CAAkBL,IAAI,CAACM,IAAL,EAAlB;AAEC;AACJ,SARD;AASH,OAXD,EAWGC,KAAK,IAAG;AACPb,QAAAA,OAAO,CAACC,GAAR,CAAYY,KAAZ;AACH,OAbD;AAgBA,aAAM,EACF,GAAGpB,SADD;AAEFF,QAAAA,QAAQ,EAAEQ;AAFR,OAAN;;AAKJ,SAAK,oBAAL;AACI,UAAIe,SAAS,GAAG,CAAC,GAAGrB,SAAS,CAACH,KAAd,CAAhB;AAEA,UAAIyB,YAAJ;AACApB,MAAAA,YAAY,CACPqB,KADL,CACW,QADX,EACqB,IADrB,EAC4B,GAAEtB,MAAM,CAACuB,QAAS,EAD9C,EAESC,GAFT,GAGSC,IAHT,CAGehB,QAAQ,IAAI;AACfA,QAAAA,QAAQ,CAACE,OAAT,CAAkBe,IAAI,IAAI;AACtBL,UAAAA,YAAY,GAAGK,IAAI,CAACR,IAAL,EAAf;AACA,iBAAOG,YAAP;AACH,SAHD;AAIH,OART,EASSM,KATT,CASiBR,KAAD,IAAWb,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BY,KAA9B,CAT3B;AAUAb,MAAAA,OAAO,CAACC,GAAR,CAAYP,MAAZ,EAAoBqB,YAApB;AACA,aAAM,EACF,GAAGtB,SADD;AAEFH,QAAAA,KAAK,EAAEwB;AAFL,OAAN;;AAMJ;AACI,aAAOrB,SAAP;AAhDR,GALyD,CAuDjD;;AAEX,CAzDM","sourcesContent":["\nimport { db } from './firebase'\n\nexport const initialState = {\n    users: [],\n    products: []\n\n};\n\n\nexport const reducer = (prevState = initialState, action) => {\n    const customersRef = db.collection('user')\n    const productsRef = db.collection('product')\n\n\n    switch(action.type) {\n\n        case \"fetch_products\":\n            let copyProducts = [...prevState.products]\n            console.log(action)\n            productsRef \n            .onSnapshot((snapshot) => {\n                snapshot.docs.forEach( item => {\n\n                    let itemExists = copyProducts.find( product => product.product_id === action.item.product_id);\n\n                    if(!itemExists) {\n                    copyProducts.push(item.data())\n\n                    }\n                })\n            }, error =>{\n                console.log(error)\n            })\n                 \n\n            return{\n                ...prevState, \n                products: copyProducts,\n            }\n\n        case \"fetch_user_details\":\n            let copyUsers = [...prevState.users]\n\n            let selectedUser;\n            customersRef\n                .where(\"userID\", \"==\", `${action.targetID}`)\n                    .get()\n                    .then( snapshot => {\n                        snapshot.forEach( user => {\n                            selectedUser = user.data()\n                            return selectedUser\n                        })\n                    })\n                    .catch( (error) => console.log(\"Update Error: \", error))\n            console.log(action, selectedUser)\n            return{\n                ...prevState,\n                users: copyUsers,\n            }\n\n\n        default: \n            return prevState;\n    }\n            // return prevState;\n\n}\n\n"]},"metadata":{},"sourceType":"module"}